machine:
  timezone:
    Europe/Copenhagen
general:
  artifacts:
    - "/home/ubuntu/clean/reports/screenshots"

  node:
    version: 6

  # This will be added to the `/etc/hosts` file
  hosts:
    checkout-com-plugin.dev: 127.0.0.1

dependencies:
  pre:
    # No password is required for the MySQL user `ubuntu`
    - sudo add-apt-repository ppa:ondrej/php -y
    - sudo apt-get update
    - sudo apt-get install php5.6 -y 
    - sudo apt-get install php5.6-mbstring php5.6-mcrypt php5.6-mysql php5.6-xml -y
    - sudo sudo a2dismod php5
    - sudo service apache2 restart
    - sudo apt-get install php5.6-xml
    - sudo apt-get install curl -y
    - sudo curl -sS https://getcomposer.org/installer | sudo php -- --install-dir=/usr/local/bin --filename=composer
    - sudo php -v
    - mysql -u ubuntu -e "create database magento"
    - sudo cp ~/clean/000-default.conf /etc/apache2/sites-available
    - sudo service apache2 restart
    - cd /home/ubuntu/clean/meh
    - composer init --no-interaction
    - cd meh
    - sudo mkdir magento2
    - sudo chmod 777 magento2
    - sudo chmod 775 /usr/local/bin
    - sudo chmod -R 777 /home/ubuntu/.composer
    - composer config -a http-basic.repo.magento.com e3fe1cabf752165bd79fbbbcb0e626fd 11543462ae0104c9792bd3d79b57663a
    - composer create-project --repository-url=https://repo.magento.com/ magento/project-community-edition=2.1.7 magento2
    - sudo composer install
    - sudo chmod -R 777 magento2


  post:
    - yarn 
    # Copy Apache conf into `site-available`
    #- sudo cp ~/clean/000-default.conf /etc/apache2/sites-available
    
    # Use `a2ensite` to create a symlink for the config
    #- a2ensite apache-ci.conf
    
    # Restart the Apache server
    #- sudo service apache2 restart


test:
  override:
    # This is just for us to see that the WP Pusher plugin was actually installed and is active
    #- ./wp-cli.phar plugin list --path=wordpress
    
    # Finally, run our Behat features
    #- vendor/bin/behat